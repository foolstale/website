<!doctype html>
<html lang="en" class="theme-dark">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Contact - Andrew Watson</title>
    <meta name="description" content="Contact Andrew Watson with questions, requests, or opportunities." />

    <link rel="icon" href="assets/Favicon.png" />
    <link rel="apple-touch-icon" href="assets/Favicon.png" />
    <link rel="stylesheet" href="styles.css" />
    <script>
      (function(){
        try {
          var t = localStorage.getItem('theme');
          if (t === 'light') document.documentElement.classList.remove('theme-dark');
          else document.documentElement.classList.add('theme-dark');
        } catch (e) {}
      })();
    </script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer"/>

  </head>
  <body>
    <a class="skip-link" href="#content">Skip to content</a>

    <header class="site-header">
      <div class="container header-inner">
        <a href="index.html" class="brand">Andrew Watson</a>
        <nav class="nav" id="site-nav">
          <a href="series/shadowbinders/index.html">Books</a>
          <a href="maps/tarris.html">Map</a>
          <a href="index.html#about">About</a>
          <a href="index.html#newsletter">Newsletter</a>
          <a href="contact.html" aria-current="page">Contact</a>
        </nav>
        <button class="menu-toggle" aria-label="Menu" aria-controls="site-nav" aria-expanded="false">
          <span class="menu-icon" aria-hidden="true"></span>
        </button>
        <!-- <button class="theme-toggle" aria-label="Toggle theme" title="Toggle theme">
          <span class="sun" aria-hidden="true"></span>
          <span class="moon" aria-hidden="true"></span>
        </button> -->
      </div>
    </header>

    <main id="content">
      <section class="section">
        <div class="container">
          <h1 class="section-title">Contact</h1>
          <p class="section-kicker">Got a question or request?</p>

          <!-- Web3Forms: action fallback for non-JS browsers; AJAX keeps users on the same page -->
          <form class="contact-form" action="https://api.web3forms.com/submit" method="POST" novalidate>
            <!-- Web3Forms required access key -->
            <input type="hidden" name="access_key" value="bb8418e4-bc53-499f-9082-8b10f0946c19">
            <!-- Friendly sender name shown in inbox -->
            <input type="hidden" name="from_name" value="Andrew Watson — Website">
            <!-- Simple bot trap (hidden from users) -->
            <input type="checkbox" name="botcheck" style="display:none">

            <div class="form-field">
              <label for="name">Name</label>
              <input id="name" name="name" type="text" required />
            </div>

            <div class="form-field">
              <label for="email">Email</label>
              <input id="email" name="email" type="email" required />
            </div>

            <div class="form-field">
              <label for="subject">Subject <span class="label-optional" aria-hidden="true">(optional)</span></label>
              <input id="subject" name="subject" type="text" />
            </div>

            <div class="form-field">
              <label for="message">Message</label>
              <textarea id="message" name="message" rows="7" required></textarea>
            </div>

            <div class="form-actions">
              <button type="submit" class="btn btn-primary">Send Message</button>
            </div>
            <div class="form-success" role="status" aria-live="polite" hidden>
              Thanks! Your message has been sent.
            </div>
          </form>
        </div>
      </section>
    </main>

    <footer class="site-footer">
      <div class="container footer-inner">
        <div class="footer-brand">© <span id="year"></span> Andrew Watson</div>
        <div class="footer-links">
          <a href="https://www.youtube.com/@the_fools_tale/" target="_blank" rel="noopener" aria-label="YouTube" class="icon-link">
            <i class="fa-brands fa-youtube"></i>
          </a>
          <a href="https://instagram.com/the_fools_tale" target="_blank" rel="noopener" aria-label="Instagram" class="icon-link">
            <i class="fa-brands fa-instagram"></i>
          </a>
          <a href="https://x.com/AndrewTheWatson" target="_blank" rel="noopener" aria-label="X (Twitter)" class="icon-link">
            <i class="fa-brands fa-x-twitter"></i>
          </a>
          <a href="https://discord.gg/4MXUYMmemK" target="_blank" rel="noopener" aria-label="Discord" class="icon-link">
            <i class="fa-brands fa-discord"></i>
          </a>
          <a href="https://www.patreon.com/thefoolstale" target="_blank" rel="noopener" aria-label="Patreon" class="icon-link">
            <i class="fa-brands fa-patreon"></i>
          </a>
        </div>
      </div>
    </footer>

    <script src="script.js"></script>

    <!-- AJAX submit to Web3Forms. Keeps users on the page and shows existing success element -->
    <script>
      document.addEventListener('DOMContentLoaded', function(){
        var form = document.querySelector('.contact-form');
        var successEl = document.querySelector('.form-success');

        if (!form) return;

        form.addEventListener('submit', async function(e){
          e.preventDefault();

          if (form.checkValidity && !form.checkValidity()) {
            form.reportValidity && form.reportValidity();
            return;
          }

          // Build form data (includes hidden access_key/from_name)
          var fd = new FormData(form);

          // Tidy up the subject to match your previous style
          var name = (fd.get('name') || '').toString().trim() || 'Unknown';
          var rawSubject = (fd.get('subject') || '').toString().trim();
          fd.set('subject', '[FORM] ' + name + ' - ' + (rawSubject || 'Message'));

          // Ensure replies go to the sender
          var senderEmail = (fd.get('email') || '').toString().trim();
          if (senderEmail) fd.set('replyto', senderEmail);

          // Add a timestamp (optional, helpful for logs)
          fd.set('_submitted_at', new Date().toISOString());

          try {
            var res = await fetch('https://api.web3forms.com/submit', {
              method: 'POST',
              headers: { 'Accept': 'application/json' },
              body: fd
            });

            var data = null;
            try { data = await res.json(); } catch (err) { /* ignore */ }

            if (res.ok && data && data.success) {
              // show success inline, keep same layout
              successEl.hidden = false;
              form.reset();
            } else {
              // fallback message for errors
              var msg = (data && data.message) ? data.message : 'Sorry, something went wrong sending your message.';
              alert(msg);
            }
          } catch (err) {
            alert('Network error - please try again.');
          }
        });
      });
    </script>
  </body>
</html>
